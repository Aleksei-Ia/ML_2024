–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ1 (base), Homework #1 (Base)

–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –∏ —Å –∫–∞–∫–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:
1. –ü—Ä–æ–≤–µ–¥—ë–Ω –ø—Ä–æ—Å—Ç–µ–π—à–∏–π EDA –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∫ –æ–±—É—á–µ–Ω–∏—é,
2. –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ pairplot, —Ç–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è–º–∏ –ü–∏—Ä—Å–æ–Ω–∞. –ü–æ –≥—Ä–∞—Ñ–∏–∫—É –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —Å–≤—è–∑—å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏: year, km_driven, engine, –∏ max_power. –ü—Ä–∏–∑–Ω–∞–∫–∏ mileage, torque, –∏ seats –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –±–æ–ª–µ–µ —Å–ª–∞–±—É—é —Å–≤—è–∑—å,
3. –û–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –µ—ë –æ—Ü–µ–Ω–∫–∞ R^2 –∏ MSE –≥–¥–µ R2 –¥–ª—è —Ç–µ—Å—Ç–∞: 0.5945; MSE –¥–ª—è —Ç–µ—Å—Ç–∞: 233097066692.6146; R2 –¥–ª—è —Ç—Ä–µ–π–Ω–∞: 0.5923; MSE –¥–ª—è —Ç—Ä–µ–π–Ω–∞: 116875266859.4052,
4. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ StandardScaler,
5. –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ Œ≤i. –ù–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏ —Ü–µ–Ω—ã —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫ year —Å—Ä–µ–¥–∏ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤,
6. –û–±—É—á–µ–Ω–∞ Lasso —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö. R^2 –¥–ª—è Lasso —Ç—Ä–µ–π–Ω–∞: 0.5923; MSE –¥–ª—è Lasso —Ç—Ä–µ–π–Ω–∞: 116875266870.5470; R^2 –¥–ª—è Lasso —Ç–µ—Å—Ç–∞: 0.5945; MSE –¥–ª—è Lasso —Ç–µ—Å—Ç–∞: 233097774128.8036. –í–≤–∏–¥—É –º–∞–ª–æ–≥–æ –∫–æ–ª–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –Ω–∞–ª–∏—á–∏—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π —Å target —É –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö Lasso –Ω–µ –∑–∞–Ω—É–ª—è–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏,
7. –û–±—É—á–µ–Ω–∞ Lasso —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö —Å –ø—Ä–∏–º–∏–Ω–µ–Ω–∏–µ–º –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏. R^2 –¥–ª—è Lasso —Ç—Ä–µ–π–Ω–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 0.5922; MSE –¥–ª—è Lasso —Ç—Ä–µ–π–Ω–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 116886342034.7602; R^2 –¥–ª—è Lasso —Ç–µ—Å—Ç–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 0.5932; MSE –¥–ª—è Lasso —Ç–µ—Å—Ç–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 233812622613.3236,
8. –û–±—É—á–µ–Ω–∞ ElasticNet —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö —Å –ø—Ä–∏–º–∏–Ω–µ–Ω–∏–µ–º –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏. R^2 –¥–ª—è ElasticNet —Ç—Ä–µ–π–Ω–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 0.5896; MSE –¥–ª—è ElasticNet —Ç—Ä–µ–π–Ω–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 117630289608.1200; R^2 –¥–ª—è ElasticNet —Ç–µ—Å—Ç–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 0.5770; MSE –¥–ª—è ElasticNet —Ç–µ—Å—Ç–∞ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: 243129607740.0414,
9. –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
10. –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–µ—Ç–æ–¥–æ–º One-Hot Encoding,
11. –û–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å Ridge —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ —Å –ø—Ä–∏–º–∏–Ω–µ–Ω–∏–µ–º –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏. –õ—É—á—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ R2 –¥–ª—è —Ç—Ä–µ–π–Ω–∞: 0.7692926231567108; –ó–Ω–∞—á–µ–Ω–∏–µ R^2 –¥–ª—è —Ç–µ—Å—Ç–∞: 0.9104859007128742; –ó–Ω–∞—á–µ–Ω–∏–µ MSE –¥–ª—è —Ç—Ä–µ–π–Ω–∞: 28939334544.7721; –ó–Ω–∞—á–µ–Ω–∏–µ MSE –¥–ª—è —Ç–µ—Å—Ç–∞: 51455260402.4948,
12. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –¥–æ–ª—é –ø—Ä–æ–≥–Ω–æ–∑–æ–≤, –æ—Ç–ª–∏—á–∞—é—â–∏—Ö—Å—è –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω –Ω–∞ –∞–≤—Ç–æ –Ω–µ –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 10% –¥–ª—è –≤—Å–µ—Ö –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π. –°–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —É Ridge –º–æ–¥–µ–ª–∏: –Ω–∞ —Ç–µ—Å—Ç–µ: 36.30%; –Ω–∞ —Ç—Ä–µ–π–Ω–µ: 35.03%,
13. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤–µ–±-—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏ FastAPI, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –∞–¥—Ä–µ—Å –∫ —Å–∫—Ä–∏–Ω–∫–∞—Å—Ç—É –Ω–∏–∂–µ,
14. –ó–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –∫–æ—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∏—â Sabrina Sadiekh (@sabrina_sadiekh).

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π "–±—É—Å—Ç" –¥–∞–ª–æ –≤–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–æ–ª–±—Ü–∞ 'name'

–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤ –ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö R^2 –∏ MSE –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Ridge —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

-------------------------------------------------------------------------------
What was done and Results:
1. Conducted simple EDA and feature processing, resulting in data being preliminarily prepared for training,
2. Created visualizations: pair plots and Pearson correlation heatmaps. The graphs reveal relationships between the target variable and features: year, km_driven, engine, and max_power. Features mileage, torque, and seats show weaker relationships,
3. Trained a classical linear regression model using only numerical features and evaluated it: R^2 for test: 0.5945; MSE for test: 233097066692.6146; R^2 for train: 0.5923; MSE for train: 116875266859.4052,
4. Standardized the features using StandardScaler,
5. Assessed the coefficients ùõΩùëñ. The feature year is the most informative for predicting price among numerical features,
6. Trained a Lasso regression model using only numerical features. R^2 for Lasso train: 0.5923; MSE for Lasso train: 116875266870.5470; R^2 for Lasso test: 0.5945; MSE for Lasso test: 233097774128.8036. Due to the small number of features and their correlations with 
the target, Lasso did not eliminate any features,
7. Trained a Lasso regression model using only numerical features with cross-validation. R^2 for Lasso train with cross-validation: 0.5922; MSE for Lasso train with cross-validation: 116886342034.7602; R^2 for Lasso test with cross-validation: 0.5932; MSE for Lasso test with cross-validation: 233812622613.3236,
8. Trained an ElasticNet regression model using only numerical features with cross-validation. R^2 for ElasticNet train with cross-validation: 0.5896; MSE for ElasticNet train with cross-validation: 117630289608.1200; R^2 for ElasticNet test with cross-validation: 0.5770; MSE for ElasticNet test with cross-validation: 243129607740.0414,
9. Added categorical features, performed additional feature processing,
10. Encoded categorical features using One-Hot Encoding,
11. Trained a Ridge regression model on the processed dataframe with cross-validation. Best results: R^2 for train: 0.7692926231567108; R^2 for test: 0.9104859007128742; MSE for train: 28939334544.7721; MSE for test: 51455260402.4948,
12. Built a custom metric showing the share of predictions differing from actual car prices by no more than 10% for all trained models. The highest score was achieved by the Ridge model: on test: 36.30%; on train: 35.03%,
13. Developed a web service to apply the trained model to new data using FastAPI, screenshots, and a link to the screencast provided below,
14. Recorded the hypothesis that the cat in the last photo belongs to Sabrina Sadiekh (@sabrina_sadiekh).

The inclusion of categorical features, especially processing the name column, provided the most significant boost.

A larger dataset is required to reduce the discrepancy in R^2 and MSE values between the train and test datasets for the Ridge regression.

-------------------------------------------------------------------------------
–í—ã–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª csv (1) –≤–∫–ª—é—á–∞—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü selling_prise –∏ predictions![Downloaded csv file (1) including the columns selling_prise and predictions](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201309.png)
–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª csv (1) –≤–∫–ª—é—á–∞—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü selling_prise![Uploaded csv file (1) including the column selling_prise](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201333.png)
–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª csv (2) –±–µ–∑ —Å—Ç–æ–ª–±—Ü–∞ selling_prise![Uploaded csv file (2) without the column selling_price](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201348.png)
–í—ã–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª csv (2) –≤–∫–ª—é—á–∞—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü predictions![Downloaded csv file (2) including the column predictions](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201404.png)
–¢–µ—Ä–º–∏–Ω–∞–ª –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–∏—Å–∞![Terminal After Service Launch](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201446.png)
–†–∞–±–æ—Ç–∞ predict_csv –ø—Ä–∏ –ø–æ–º–æ—â–∏ FastAPI-Swagger_UI –≤ –±—Ä–∞—É–∑–µ—Ä–µ![Running predict_csv with FastAPI via Swagger UI in browser](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201557.png)
–†–∞–±–æ—Ç–∞ predict_item –ø—Ä–∏ –ø–æ–º–æ—â–∏ FastAPI-Swagger_UI –≤ –±—Ä–∞—É–∑–µ—Ä–µ![Running predict_item with FastAPI via Swagger UI in browser](https://github.com/Aleksei-Ia/ML_2024/blob/1268575027471b9b8104cf56cf625eb9ff1bf4bd/Images/2024-12-04_201917.png)

–°—Å—ã–ª–∫–∞ –∫ —Å–∫—Ä–∏–Ω–∫–∞—Å—Ç—É, screencast link
[Google Drive](https://drive.google.com/file/d/1Tmamng4XC53j_2MLMmQsZ2vTi0krn4Fp/view?usp=sharing)
